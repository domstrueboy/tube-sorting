# Некоторые замечания:

* Программа написана на языке JavaScript с использованием ElectronJS (https://electronjs.org/). ElectronJS позволяет делать десктопные программы на JS. Получается просто, но не без недостатков. Например, он встраивает движок Chromium для интерпретации JS и отображения html/css в каждую программу. 
* Для сборки должны быть установлены следующие программы:
nodejs (https://nodejs.org/en/), yarn (https://yarnpkg.com/en/), windows-build-tools (https://github.com/felixrieseberg/windows-build-tools)

* Для "реактивной" связи данных с интерфейсом используется фреймворк VueJS (https://ru.vuejs.org/). Реактивная связь - если данные меняются, интерфейс отрисовывает это автоматически.
* Для хранения данных используется простая база данных LowDB (https://www.npmjs.com/package/lowdb). Собственно, база хранится в файле JSON, это текстовый формат, его можно читать и изменять в любом текстовом редакторе. Это сделано для того, чтобы при написании полноценной программы на другом языке и т.п. данные было легко использовать или сконвертировать в любой другой формат.

# Как запустить:

* Установка зависимостей:
    - Если используется npm: команда `npm i` в консоли
    - Если используется yarn: команда `yarn` в консоли

* Запуск в режиме разработки:
    - Если используется npm: команда `npm start` в консоли
    - Если используется yarn: команда `yarn start` в консоли

* Сборка программы для Windows:
    - Если используется npm: команда `npm run package-win` в консоли
    - Если используется yarn: команда `yarn run package-win` в консоли

*Нужно иметь в виду, что через прокси установка зависимостей не будет работать. Нужно либо пробрасывать порт, либо танцевать с бубном, чтобы настроить работу npm через прокси. В нашем случае проще установить, например, дома, без прокси.*

# О структуре программы:

В папке программы содержатся следующие данные:
* папка `Исходники` - собственно, исходники. Содержимое распишу отдельно.
* папка `База данных` - здесь лежит файл с базой данных `db.json`.
* папка `TubeSorting-win32-ia32` - генерируется автоматически при сборке проекта. Я оставлю её пустой, она заполнится при сборке.
* папка `Вспомогательные скрипты` - скрипты для конвертации базы и т.п. Это на всякий случай.
* Ярлык `Подбор трубок.lnk` - ярлык на exe-файл программы

# Структура папка "Исходники":

* Точка входа в приложение - файла `index.html`. Здесь содержится базовая, неизменная для всех изделий, разметка (шапка программы, модальное окно просмотра архива). Здесь также подключаются изменяемые компоненты интерфейса, с помощью тегов `component`.
* Начать стоит с файла `renderer.js` - в нём содержится основная логика работы программы. Комментарии по нему почти завершены. Но это только комментарии. Будет ещё отдельный текст с картинками, описывающий работу программы. Пока он не готов. 
* В папке `components` лежат шаблоны интерфейса, сгруппированные по изделиям
* В папке `modules` лежат программные модули - классы, сгруппированные по изделиям, а также общие функции. Комментарии по ним допишу к завтрашнему дню. Скорее всего, на примере одного изделия, потому что они подобны.
* В папке `libs` лежит пока одна библиотека `numeric.js` - для численного решения геометрии трубки Ду3.
* В папке `tests` - один тест для тестирования, опять же, численного решения геометрии трубки Ду3.
* `node_modules` - служебная папка для хранения необходимых модулей nodejs. Она создаётся автоматически при установке зависимостей.

# Небольшой экскурс в стэк:

* ElectronJS позволяет делать десктопные приложения на стеке html/css/javascript. Делает он это за счёт того, что при сборке встраивает браузерный движок Chromium прямо в приложение. Недостаток этого в том, что даже "пустое" приложение весит в упакованном виде от 30Мб, в неупакованном - до 150Мб, при этом занимает в оперативной памяти столько же места, сколько браузер Chrome. Зато мы получаем все возможности по построению интерфейсов в браузерном стиле, доступ к файловой системе (потому что это nodejs), доступ ко всем браузерным API (видео, аудио, распознавание речи, встроенное в браузер и т.п.) и API операционной системы + сборка возможна под любую платформу Windows/Linux/Mac (мобильные не поддерживаются). Теперь по файлам. ElectronJS использует файл main.js для "фоновых процессов" (т.е. отсюда можно обращаться к системным API, напр. уведомления в трее, а также именно отсюда создаются окна). Ещё есть файл renderer.js - это тот код, который будет работать в созданном окне. Для простоты разработки я не стал углубляться и оставил main.js как есть - он только создаёт главное окно программы, а весь остальной код работает именно в renderer.js. Базовая разметка окна хранится в файле index.html.
* Для разработки интерфейса я использовал библиотеку готовых элементов bootstrap (в программе расчёта перепада давления используется vuetify). Использование готовых элементов для разработки инженерного софта я считаю целесообразным, т.к. особых изысков в плане внешнего вида всё равно не требуется, зато ускоряется разработка.
* Для упрощения взаимодействия кода с интерфейсом я использовал фреймворк VueJS. Он позволяет создать реактивную связь данных и интерфейса, т.е. интерфейс сам реагирует на изменение данных, об этом не нужно заботиться отдельно. В файле renderer.js я создаю "экземпляр приложения" VueJS и пишу код в соответствии с той структурой, которую предлагает фреймворк. Структура такова:
    - в секции `data` содержатся данные приложения. Они доступны в `index.html` через двойные фигурные скобки `{{}}`. Т.е. если в data содержится переменная `foo`, то я могу написать в `index.html` такую конструкцию `<span>{{foo}}</span>` и вместо `{{foo}}` будет отображаться значение переменной `foo`, причем если `foo` изменится, интерфейс среагирует и обновит значение. Похоже на шаблонизатор, только ещё с реактивной связью. Данные доступны извне объекта через this или app, например `this.foo` можно использовать в методах (о них позже)
    - в секции `computed` содержатся данные, вычисляемые на основе `data`. Например, в `data` есть переменные `foo` и `bar`, равные 1. Тогда в `computed` мы можем поместить некую переменную `sum`, равную `foo + bar` и она вычислится и будет вычисляться каждый раз при изменений какой-либо из входящих переменных. В интерфейсе доступно также через `{{}}` (`{{sum}}`).
    - `created` - здесь хранятся функции, выполняемые после создания экземпляра приложения Vue.
    - `watch` - здесь хранятся функции, которые выполняются при изменении отслеживаемой переменной. При этом, в отличие от computed, эти функции ничего не возвращают и не вычисляют "зависимых" переменных.
    - `methods` - методы, т.е. функции, доступные для испльзования внутри экземпляра Vue через this.someMethod, а также напрямую из интерфейса. Например, в интерфейсе можно навесить слушатель события на элемент и вызывать метод по наступлении этого события: `<button @click="someMethod()"></button>`

# Версии программы:

* Текущая версия (в папке tube-sorting): версия, с которой работают технологи. Для Ду50 и Ду50_2 (версия с трубкой с толщиной стенки 2 мм)геометрические и физические параметры вычисляются автоматически при вводе трубки, для Ду3 и Ду15 необходимо предварительно вычислить геометрические параметры через файл SolidWorks и уже вычисленные параметры ввести в программу. В этой версии программы возможности ввода поторных измерений нет.
* Перспективная версия (в папке tube-sorting-new): версия на перспективу. Главные изменения касаются Ду3, поэтому только Ду3 доступен к выбору. Добавлено автоматическое вычисление геометрических параметров для Ду3. Также введена возможность вводить и оценивать дополнительные измерения для трубок.

